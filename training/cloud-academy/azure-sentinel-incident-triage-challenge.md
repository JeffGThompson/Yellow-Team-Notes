# Azure Sentinel Incident Triage Challenge

**Create an Azure Sentinel Workspace**

Create an Azure Sentinel resource using the existing Log Analytics workspace.

* Must use the existing workspace **calabws**

****

**Create a Data Collection Rule in Sentinel**

Create a Data Collection Rule to collect Security Events from the Azure VM

* Collection Rule name must be _windows-event_
* Add the Azure VM **ca-lab-vm** to the data collection rule scope

![](<../../.gitbook/assets/image (4).png>)

*



<figure><img src="../../.gitbook/assets/image (20).png" alt=""><figcaption></figcaption></figure>





![](<../../.gitbook/assets/image (13).png>)

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>



<figure><img src="../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

The data collection must collect at least **Common** event stream

<figure><img src="../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>





<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>



**Create an Analytics Rule to Run Scheduled Queries**

Create an Analytics Rule to Run Scheduled Queries that satisfies the following:

* The rule severity should be **Medium**
* Query schedule should be set to run 5 minutes
* The log inspection script must check for EventID 4625 to report failed logins
* Use the query `SecurityEvent | where EventID == 4625`
* Try RDP access into the Azure VM by supplying an incorrect password to generate events&#x20;



Create logs

<figure><img src="../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>





Create the rule

<figure><img src="../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (11).png" alt=""><figcaption></figcaption></figure>





<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

****

<figure><img src="../../.gitbook/assets/image (17).png" alt=""><figcaption></figcaption></figure>

****

<figure><img src="../../.gitbook/assets/image (18).png" alt=""><figcaption></figcaption></figure>

Make sure alert threshold is greater than 0 so it fires if any hits happen.

<figure><img src="../../.gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>

**Leave default settings**

<figure><img src="../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

****

Leave default

<figure><img src="../../.gitbook/assets/image (9).png" alt=""><figcaption></figcaption></figure>

****

Click Create

<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

****

**Triage and Close At Lease One Incident**

Close at least one incident from the Sentinel Incidents Dashboard

* Ensure that you try RDP access into Azure VM using an incorrect password
* Wait for about 5 minutes for the analytics rule to run and analyze the data
* Close at least one of the incidents generated by analytics rule

<figure><img src="../../.gitbook/assets/image (19).png" alt=""><figcaption></figcaption></figure>





![](<../../.gitbook/assets/image (16).png>)

